---
phase: 02-blog-post-generator
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - wordpress-plugin/parkk-seo-meta-bridge.php
autonomous: true
requirements:
  - PUBL-03
  - PUBL-04

must_haves:
  truths:
    - "The PHP plugin file registers all 6 SEO meta fields (_yoast_wpseo_metadesc, _yoast_wpseo_focuskw, _yoast_wpseo_title, rank_math_focus_keyword, rank_math_description, rank_math_title) with show_in_rest: true"
    - "After activating the plugin on WordPress, a POST to /wp/v2/posts with meta containing any of the 6 SEO fields persists those fields — verified by GET /wp/v2/posts/{id} returning non-empty meta values"
    - "The plugin uses register_post_meta() with auth_callback restricting writes to users with edit_posts capability"
    - "The plugin is a minimal bridge stub — it will be absorbed into the full Phase 4 WordPress plugin later"
  artifacts:
    - path: "wordpress-plugin/parkk-seo-meta-bridge.php"
      provides: "WordPress plugin that registers SEO meta fields for REST API write access"
      contains: "register_post_meta"
  key_links:
    - from: "wordpress-plugin/parkk-seo-meta-bridge.php"
      to: "WordPress REST API"
      via: "register_post_meta() with show_in_rest: true enables meta field writes via /wp/v2/posts"
      pattern: "show_in_rest.*true"
    - from: "scripts/wp-client.js (Plan 03)"
      to: "wordpress-plugin/parkk-seo-meta-bridge.php"
      via: "wp-client.js writes SEO meta fields that this plugin registers"
      pattern: "_yoast_wpseo_|rank_math_"
---

<objective>
Create a minimal WordPress plugin stub that registers all 6 SEO meta fields (3 Yoast + 3 RankMath) with `show_in_rest: true` so the WordPress REST API accepts and persists them.

Purpose: Without this plugin, WordPress silently drops all SEO meta fields sent via the REST API (see Research Pitfall 1 and Open Question 1). The ROADMAP Phase 2 success criterion 4 requires that "The created WordPress draft has Yoast or RankMath SEO meta fields populated -- verified by fetching the post via REST API and confirming the fields are non-empty." This stub is the minimal prerequisite to satisfy that criterion. It will be absorbed into the full Phase 4 WordPress plugin (`parkk-ai-discovery.php`) later.

Output: `wordpress-plugin/parkk-seo-meta-bridge.php` -- a single-file WordPress plugin ready for upload and activation.
</objective>

<execution_context>
@/home/jratz/.claude/get-shit-done/workflows/execute-plan.md
@/home/jratz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-blog-post-generator/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create parkk-seo-meta-bridge.php WordPress plugin stub</name>
  <files>wordpress-plugin/parkk-seo-meta-bridge.php</files>
  <action>
Create directory `wordpress-plugin/` at project root if it does not exist.

Create `wordpress-plugin/parkk-seo-meta-bridge.php` with a standard WordPress plugin header and a single `init` action hook that registers all 6 SEO meta fields.

**Plugin header:**

```php
<?php
/**
 * Plugin Name: Parkk SEO Meta Bridge
 * Description: Registers Yoast and RankMath SEO meta fields for REST API write access. Minimal stub for Phase 2 pipeline testing — will be absorbed into the full Phase 4 plugin (parkk-ai-discovery.php).
 * Version: 0.1.0
 * Author: Parkk Technology
 * License: MIT
 */
```

**Meta field registration:**

Hook into `init` action and register all 6 fields using `register_post_meta()`:

```php
add_action('init', function () {
    $seo_fields = [
        // Yoast SEO fields
        '_yoast_wpseo_metadesc',
        '_yoast_wpseo_focuskw',
        '_yoast_wpseo_title',
        // RankMath fields
        'rank_math_focus_keyword',
        'rank_math_description',
        'rank_math_title',
    ];

    foreach ($seo_fields as $field) {
        register_post_meta('post', $field, [
            'show_in_rest'  => true,
            'single'        => true,
            'type'          => 'string',
            'auth_callback' => function () {
                return current_user_can('edit_posts');
            },
        ]);
    }
});
```

**Key details:**
- Register all 6 fields unconditionally (do NOT check `class_exists('WPSEO_Options')` or `class_exists('RankMath')` here -- this stub is for pipeline testing, and it must work regardless of which SEO plugin is installed or if neither is installed)
- The `auth_callback` restricts meta writes to users with `edit_posts` capability (the application password user must have this capability)
- `single: true` ensures the field stores a single value (not an array)
- `type: 'string'` matches the string values the generator sends
- No other functionality -- this is purely a meta field registration bridge

The file must be self-contained with no dependencies beyond WordPress core.
  </action>
  <verify>
    <automated>php -l wordpress-plugin/parkk-seo-meta-bridge.php && echo "PHP syntax valid"</automated>
    <manual>Verify the plugin file contains all 6 meta field names (_yoast_wpseo_metadesc, _yoast_wpseo_focuskw, _yoast_wpseo_title, rank_math_focus_keyword, rank_math_description, rank_math_title) and each is registered with show_in_rest: true, single: true, type: string, and an auth_callback</manual>
  </verify>
  <done>wordpress-plugin/parkk-seo-meta-bridge.php exists with valid PHP syntax. All 6 SEO meta fields registered unconditionally with show_in_rest: true. Plugin is ready for upload to WordPress and activation. No external dependencies beyond WordPress core.</done>
</task>

</tasks>

<verification>
1. `php -l wordpress-plugin/parkk-seo-meta-bridge.php` reports no syntax errors
2. File contains `register_post_meta` calls for all 6 SEO field names
3. All registrations include `show_in_rest => true`
4. Plugin header is valid WordPress plugin format (Plugin Name, Description, Version, Author)
5. No `class_exists()` checks -- fields registered unconditionally for testing
</verification>

<success_criteria>
- `wordpress-plugin/parkk-seo-meta-bridge.php` exists and passes PHP lint
- All 6 SEO meta fields are registered with `show_in_rest: true`, `single: true`, `type: string`
- Plugin is a single self-contained PHP file ready for WordPress upload
- Auth callback restricts writes to users with `edit_posts` capability
</success_criteria>

<output>
After completion, create `.planning/phases/02-blog-post-generator/02-05-SUMMARY.md`
</output>
